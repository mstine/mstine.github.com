<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.46" />
  <meta name="author" content="Matt Stine">
  <meta name="description" content="Global CTO - Architecture">

  <link rel="stylesheet" href="/css/highlight.min.css">
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  <link rel="alternate" href="https://www.mattstine.com/index.xml" type="application/rss+xml" title="Matt Stine">
  <link rel="feed" href="https://www.mattstine.com/index.xml" type="application/rss+xml" title="Matt Stine">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="https://www.mattstine.com/2007/06/27/how-to-implement-form-level-validation-in-jsf/">

  

  <title>how to implement form level validation in jsf | Matt Stine</title>

</head>
<body id="top">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Matt Stine</a>
    </div>

    
    <div class="collapse navbar-collapse" id="#navbar-collapse-1">

      
      <ul class="nav navbar-nav navbar-right">
        
        <li class="nav-item"><a href="/#top">Home</a></li>
        
        <li class="nav-item"><a href="/#publications">Publications</a></li>
        
        <li class="nav-item"><a href="/#posts">Posts</a></li>
        
        <li class="nav-item"><a href="/#videos">Videos</a></li>
        
        <li class="nav-item"><a href="/#articles">Articles</a></li>
        
        <li class="nav-item"><a href="/#interviews">Interviews</a></li>
        
        <li class="nav-item"><a href="/#upcoming">Appearances</a></li>
        
        <li class="nav-item"><a href="/#contact">Contact</a></li>
        
      </ul>

    </div>
  </div>
</nav>

<div class="container">

  <article class="article" itemscope itemtype="http://schema.org/Article">

    

    <h1 itemprop="name">how to implement form level validation in jsf</h1>

    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2007-06-27 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Wed, Jun 27, 2007
    </time>
  </span>

  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.mattstine.com%2f2007%2f06%2f27%2fhow-to-implement-form-level-validation-in-jsf%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=how%20to%20implement%20form%20level%20validation%20in%20jsf&amp;url=https%3a%2f%2fwww.mattstine.com%2f2007%2f06%2f27%2fhow-to-implement-form-level-validation-in-jsf%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.mattstine.com%2f2007%2f06%2f27%2fhow-to-implement-form-level-validation-in-jsf%2f&amp;title=how%20to%20implement%20form%20level%20validation%20in%20jsf"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fwww.mattstine.com%2f2007%2f06%2f27%2fhow-to-implement-form-level-validation-in-jsf%2f&amp;title=how%20to%20implement%20form%20level%20validation%20in%20jsf"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=how%20to%20implement%20form%20level%20validation%20in%20jsf&amp;body=https%3a%2f%2fwww.mattstine.com%2f2007%2f06%2f27%2fhow-to-implement-form-level-validation-in-jsf%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


    <div class="article-style" itemprop="articleBody">
      <p>Recently I was faced with the challenge of implementing form-level (or page-level) validation in a JSF-based application. What I mean by form-level validation is the need to evaluate a subset of a form&rsquo;s fields as a unit, rather than simply validating each field in isolation. An example of this type of validation can be found on a user registration form where one has to select a password in one text field, and then retype the same password in another text field for confirmation. Validating that these two text fields contain the same password is an example of form level validation.</p>

<p>In my case, I had two date selector components on my form, one for a start date/time and one for an end date/time for an event that was being scheduled. The rule I needed to validate was that the end date/time was later than the start date/time.</p>

<p>There are a few ways to implement validation like this, including but not limited to:</p>

<ol>
<li><p>Build a custom component that renders selectors for both the start and end date/time, then validate as a unit. This actually is field-level validation and doesn&rsquo;t truly address the form-level problem.</p></li>

<li><p>Implement a validator method on a managed bean that will evaluate the data submitted for multiple components.</p></li>
</ol>

<p>I&rsquo;ll address the second method in this HOWTO.</p>

<p>First, you&rsquo;ll need to bind at least <em>n-1</em> of the components that you want to validate to properties on your managed bean. The simplest way is to declare properties of type <strong>UIInput</strong>:</p>

<blockquote>
<pre><code>&lt;br&gt;&lt;/br&gt;private UIInput startDateComponent;&lt;br&gt;&lt;/br&gt;&lt;br&gt;&lt;/br&gt;public UIInput getStartDateComponent() {&lt;br&gt;&lt;/br&gt;    return startDateComponent;&lt;br&gt;&lt;/br&gt;}&lt;br&gt;&lt;/br&gt;&lt;br&gt;&lt;/br&gt;public void setStartDateComponent(UIInput startDateComponent) {  &lt;br&gt;&lt;/br&gt;    this.startDateComponent = startDateComponent;&lt;br&gt;&lt;/br&gt;}&lt;br&gt;&lt;/br&gt;
</code></pre>
</blockquote>

<p>and do the actual binding in the JSP:</p>

<blockquote>
<p><br></br><t:inputDate id="eventStart" value="#{orderForm.sampleInfo.requestedStartTime}"<br></br>    type=&ldquo;both&rdquo;<br></br>    popupCalendar=&ldquo;true&rdquo;<br></br>    ampm=&ldquo;true&rdquo; binding=&ldquo;#{dateValidationForm.startDateComponent}&rdquo;/&gt;<br></br></p>
</blockquote>

<p>Next, you&rsquo;ll implement the validation method, which can have any name you like, but must share the same signature as this example:</p>

<blockquote>
<p><br></br>public void validateEndDate(FacesContext context, UIComponent toValidate, Object value) {<br></br>    Date endDate = (Date) value;<br></br>    Date startDate = (Date) getStartDateComponent().getLocalValue();<br></br><br></br>    if (startDate == null) {<br></br>        context.addMessage(getStartDateComponent().getClientId(context),new FacesMessage(&ldquo;Please specify a valid date and time.&rdquo;));<br></br>        throw new ValidatorException(new FacesMessage());<br></br>    }<br></br><br></br>    long endTime = endDate.getTime();<br></br>    long startTime = startDate.getTime();<br></br><br></br>    if (startTime &gt;= endTime) {<br></br>        addError(&ldquo;errors.batchOrder.invalidEndDate&rdquo;);<br></br>        throw new ValidatorException(new FacesMessage(&ldquo;Event end must be later than event start.&rdquo;));<br></br>    }<br></br>}<br></br></p>
</blockquote>

<p>And finally, you&rsquo;ll bind the validation method to the last component in your subset of components that need to be validated together:</p>

<blockquote>
<p><br></br><t:inputDate id="eventEnd" value="#{orderForm.sampleInfo.requestedEndTime}" type="both" popupCalendar="true" ampm="true" validator="#{dateValidationForm.validateEndDate}"/><br></br></blockquote></p>

<p>To understand why I say <em>n-1</em> components, think of the way the validation phase occurs in JSF. Data is bound to the components in the order that they occur in the JSF component tree, which just so happens to be the order in which they appear in the JSP source. Looking at the <strong>validateEndDate</strong> method, you&rsquo;ll see that I only reference the <strong>startDateComponent</strong> from the binding, but I reference the <strong>endDate</strong> as the <strong>Object value</strong> reference that was passed into the method. This is why you only need to bind <em>n-1</em> components, because you get the <em>nth</em> component from the method signature.</p>
</blockquote>

<p>If you want to be more uniform and bind all of the components, you could create an extra dummy hidden value component and bind the validator method to it. You could then bind all of the components to your managed bean and access them all from the bindings rather than accessing one from the method signature.</p>

<p>The <strong>validateEndDate</strong> method itself is rather simple. First you access the data by getting the local value of each component (again, the <strong>endDate</strong> value is not accessed in this way - in fact, it hasn&rsquo;t been bound yet because it must be validated first, and that&rsquo;s what&rsquo;s happening in this method!). You then apply the business rule. You&rsquo;ll see that first I look to see if the <strong>startDate</strong> is null. I&rsquo;m not sure why this is possible, but if the <strong>startDate</strong> was not submitting a good value on the FIRST submit, the local value was null. So, I catch that here. I add an error message to the <strong>startDateComponent</strong> and throw a <strong>ValidatorException</strong>. If the business rule is violated, throw a <strong>ValidatorException</strong>. (I&rsquo;m also using the <strong>addError</strong> method provided by AppFuse to work w/ its message framework as well, but that is not necessary w/ all JSF apps).</p>

<p>Now, for the final problem I encountered. In Weblogic server, which we&rsquo;re still using for the time being, if your session cannot be serialized then it deletes your entire session. Obviously this can cause major problems in any web app. To deal with this, ANY SESSION SCOPED MANAGED BEAN must be fully serializable, meaning it and any objects referenced in its state. Herein lies the problem for JSF. Instances of <strong>UIComponent</strong> (an ancestor of <strong>UIInput</strong>) are not serializable, so if we bind our components to <strong>UIInput</strong> fields on a session-scoped managed bean (the bean backing this form is an Order Form/Shopping Cart style bean), it will not be serializable and Weblogic will kick out your session.</p>

<p>To deal with this problem, realize that there is no reason that you can only have one managed bean backing a form. In fact, you can reference as many managed beans as you need. Since validation is done for each request, there is no need to manage any state there across multiple requests like we need to do with a shopping cart. So, why not declare an additional managed bean that is REQUEST SCOPED, and then put the bindings and validation method there. That is exactly what I did. Here is the entire bean:</p>

<blockquote>
<blockquote>
<p><br></br>public class DateValidationForm extends BasePage {<br></br><br></br>    private UIInput startDateComponent;<br></br><br></br>    public UIInput getStartDateComponent() {<br></br>        return startDateComponent;<br></br>    }<br></br> <br></br>    public void setStartDateComponent(UIInput startDateComponent) {<br></br>        this.startDateComponent = startDateComponent;<br></br>    }<br></br><br></br>    public void validateEndDate(FacesContext context, UIComponent toValidate, Object value) {<br></br>        Date endDate = (Date) value;<br></br>        Date startDate = (Date) getStartDateComponent().getLocalValue();<br></br><br></br>        if (startDate == null) {<br></br>            context.addMessage(getStartDateComponent().getClientId(context),new FacesMessage(&ldquo;Please specify a valid date and time.&rdquo;));<br></br>            throw new ValidatorException(new FacesMessage());<br></br>        }<br></br><br></br>        long endTime = endDate.getTime();<br></br>        long startTime = startDate.getTime();<br></br><br></br>        if (startTime &gt;= endTime) {<br></br>            addError(&ldquo;errors.batchOrder.invalidEndDate&rdquo;);<br></br>            throw new ValidatorException(new FacesMessage(&ldquo;Event end must be later than event start.&rdquo;));<br></br>        }<br></br>    }<br></br>}<br></br></p>
</blockquote>

<p>and the declaration in faces-config.xml:</p>

<blockquote>
<p><br></br><managed-bean><br></br>    <managed-bean-name>dateValidationForm</managed-bean-name><br></br>    <managed-bean-class>org.stjude.hc.srmcti.webapp.action.ordering.
    DateValidationForm</managed-bean-class><br></br>    <managed-bean-scope>request</managed-bean-scope><br></br></managed-bean><br></br></p>
</blockquote>

<p>The added bonus is that you can reuse this bean across all forms where you need this behavior. My application happens to have 2 additional forms where I would have repeated this logic, so I just reference this bean there.</p>
</blockquote>

<p>Enjoy!</p>

    </div>

  </article>

  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="https://www.mattstine.com/2007/06/22/the-grove-coffee-house-rocks/"><span
      aria-hidden="true">&larr;</span> the grove coffee house rocks</a></li>
    

    
    <li class="next"><a href="https://www.mattstine.com/2007/07/02/help-me-become-a-better-programmer/">help me become a better programmer <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

  
<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "seekingsimplicity" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>



</div>
<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 Matt Stine &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-8534802-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    

  </body>
</html>

